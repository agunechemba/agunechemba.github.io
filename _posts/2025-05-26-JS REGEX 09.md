# JS REGEX 09: Dynamic Text Replacement with `replace()` and Callback Functions in JavaScript

<img src="https://agunechembaekene.wordpress.com/wp-content/uploads/2025/05/a_child_replace_a_white_floor_tile.jpeg" width="100%" alt="Child replacing a white floor tile">

When most people think of `string.replace()`, they picture something simple ‚Äî changing `"old"` to `"new"`.
But in the hands of a creative coder, `replace()` can do far more.

What if you want every match to be treated differently ‚Äî for example, numbering each occurrence, modifying case, or looking up values dynamically from a data object?
That‚Äôs when **callback functions** step into the scene.

Let‚Äôs break this down step by step.

---

## üß† What Is a Callback Function?

A **callback function** is simply a *function passed as an argument* to another function, so that the receiving function can **call it when needed**.

In the context of `replace()`, JavaScript calls *your* function every time a match is found in the text.
Whatever value your callback returns will be used as the replacement for that specific match.

That means instead of a static replacement, you now have **dynamic power** ‚Äî the ability to compute, transform, and decide the replacement *on the fly*.

---

## ‚öôÔ∏è The Anatomy of `replace()` with a Function

The method signature looks like this:

```js
string.replace(regexp, function(match, group1, group2, ..., offset, fullString) { ... })
```

### Let‚Äôs unpack this:

| Parameter             | Meaning                                                           |
| --------------------- | ----------------------------------------------------------------- |
| `match`               | The exact substring matched by the regex.                         |
| `group1, group2, ...` | Values captured by parentheses `( )` in your regex.               |
| `offset`              | The index position in the original string where the match begins. |
| `fullString`          | The entire string being processed.                                |

When the regex uses the global flag `g`, this callback is invoked **for every single match**.

---

## üîπ Example 1: Replace Based on Position

Let‚Äôs start with a friendly scenario.

**Goal:** Replace the first `"Some"` with `"Start"` and the second one with `"End"`.

```js
const text = "Some string Some";

const result = text.replace(/Some/g, (match, offset, fullString) => {
  if (offset === 0) {
    return 'Start';
  } else {
    return 'End';
  }
});

console.log(result); // "Start string End"
```

### üí¨ What‚Äôs Happening:

1. The regular expression `/Some/g` looks for every instance of `"Some"` globally.
2. The callback runs **twice**, once for each match.
3. For the first `"Some"`, the `offset` (its position) is `0`, so we return `"Start"`.
4. For the second `"Some"`, the `offset` is `10`, so we return `"End"`.
5. The string is reconstructed as `"Start string End"`.

This demonstrates how `replace()` can make context-aware decisions!

---

## üîπ Example 2: Building Templates Dynamically

Imagine you‚Äôre designing a small **templating engine** ‚Äî the kind that fills in `{placeholders}` with real values.
Let‚Äôs do that elegantly with a callback.

```js
const template = "My name is {surname}, {name} {surname}";
const data = { name: "John", surname: "Doe" };

const result = template.replace(/{(.+?)}/g, (match, key) => {
  return data[key];
});

console.log(result); // "My name is Doe, John Doe"
```

### üí¨ Step-by-Step Breakdown:

1. The regex `/{(.+?)}/g` captures anything inside curly braces `{ }`.

   * The parentheses `( )` create a **capturing group**, so the content (e.g. `name`) is stored in `key`.
2. The callback is executed for each match found:

   * For `{surname}` ‚Üí `key = "surname"`
   * For `{name}` ‚Üí `key = "name"`
3. Inside the callback, we return the corresponding value from our `data` object.
4. `replace()` builds the final string using those returned values.

üí° Notice that this approach is **data-driven** ‚Äî if you change your object, the text automatically updates. That‚Äôs a taste of how templating engines like Handlebars or Mustache work under the hood.

---

## üîπ Example 3: Transforming Matches Mathematically

Let‚Äôs go further ‚Äî suppose we want to double every number found in a string.

```js
const text = "3 apples and 5 oranges";
const result = text.replace(/\d+/g, (num) => {
  return num * 2;
});

console.log(result); // "6 apples and 10 oranges"
```

### üí¨ Explanation:

* The regex `/\d+/g` matches every sequence of digits.
* Each match is passed as `num` to the callback.
* The callback doubles it (`num * 2`).
* The returned value replaces the original number.

This is dynamic text replacement at its best ‚Äî your logic runs per match.

---

## üîπ Example 4: Case Transformation

Want to capitalize every word?

```js
const sentence = "hello world";
const result = sentence.replace(/\b\w/g, (char) => char.toUpperCase());
console.log(result); // "Hello World"
```

The regex `\b\w` matches the **first letter of every word** (`\b` = word boundary, `\w` = word character).
Each letter is uppercased by the callback.

---

## üß© Why Use Callback Functions in `replace()`?

Because they make your string transformations **intelligent**.
Instead of blindly substituting text, you can:

* **Compute** new values (`num * 2`)
* **Reference external data** (`data[key]`)
* **React to context** (`offset` position)
* **Use conditions** to replace selectively

In short: callback functions make `replace()` **dynamic**, **context-aware**, and **programmable**.

---

## üß† Summary Table

| Concept                     | Description                              |
| --------------------------- | ---------------------------------------- |
| `replace(regexp, callback)` | Invokes your function for each match     |
| `match`                     | The actual substring matched             |
| `offset`                    | Index where the match begins             |
| `fullString`                | The full string being processed          |
| Callback return value       | The replacement text used for that match |

---

## üß™ Practice Time ‚Äî Let‚Äôs Code!

1Ô∏è‚É£ Replace every number in a string with its **double**.
‚û° Example: `"4 cats and 7 dogs"` ‚Üí `"8 cats and 14 dogs"`

2Ô∏è‚É£ Capitalize every **first letter** of a word.
‚û° Example: `"learn javascript"` ‚Üí `"Learn Javascript"`

3Ô∏è‚É£ Replace placeholders like `{city}` in `"Welcome to {city}"`
‚û° With data `{ city: "Lagos" }` ‚Üí `"Welcome to Lagos"`

4Ô∏è‚É£ Replace only **even numbers** in `"1 2 3 4 5"` with `"even"`.
‚û° Result: `"1 even 3 even 5"`

5Ô∏è‚É£ Replace each **vowel** with its uppercase version.
‚û° `"hello world"` ‚Üí `"hEllO wOrld"`

---

## üß© Review Fill-Gap Questions

1. A **callback function** is a function passed as an __________ to another function.
2. In `replace()`, the callback runs once for every __________ found.
3. The first parameter of the callback is always the __________ text.
4. The `offset` parameter represents the match‚Äôs __________ in the string.
5. Capturing groups inside the RegExp are returned as additional __________.
6. The value returned by the callback becomes the actual __________ for that match.
7. Using `/\d+/g` matches all sequences of __________.
8. To transform only the first letter of every word, use the boundary symbol __________.
9. Callback-based replacements make `replace()` more __________ and flexible.
10. In the template example, `data[key]` retrieves the value corresponding to the __________ found inside `{ }`.
